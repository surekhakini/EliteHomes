<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Properties | EliteHomes</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #F5F7FA;
            color: #0A2540;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        /* ---------- Navbar ---------- */
        header {
            background-color: #0A2540;
            padding: 18px 80px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        header .logo {
            font-size: 24px;
            font-weight: 700;
            color: #FFFFFF;
        }

        header .logo span {
            color: #C9A227;
        }

        nav a {
            color: #FFFFFF;
            margin-left: 30px;
            font-size: 15px;
            font-weight: 500;
        }

        nav a:hover {
            color: #C9A227;
        }

        /* ---------- Page Header ---------- */
        .page-header {
            background-color: #FFFFFF;
            padding: 60px 80px;
            text-align: center;
        }

        .page-header h1 {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .page-header p {
            font-size: 16px;
            color: #555;
        }

        /* ---------- Properties Section ---------- */
        .content {
            padding: 60px 80px;
        }

        .info-box {
            background: #FFFFFF;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 8px 20px rgba(0,0,0,0.08);
            text-align: center;
        }

        .info-box h2 {
            margin-bottom: 15px;
        }

        .info-box p {
            color: #555;
            line-height: 1.6;
        }

        /* ---------- Footer ---------- */
        footer {
            background-color: #0A2540;
            color: #FFFFFF;
            padding: 40px 80px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 60px;
        }

        footer p {
            font-size: 14px;
        }
        .property-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 25px;
    margin-top: 20px;
}

.property-card {
    background: #FFFFFF;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 6px 18px rgba(0,0,0,0.1);
}

.property-card img {
    width: 100%;
    height: 400px;
    object-fit: cover;
}

.property-info {
    padding: 15px;
}

.property-info h3 {
    margin-bottom: 8px;
}

.property-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 25px;
}

.property-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.property-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 14px 30px rgba(0,0,0,0.2);
}


.price {
    font-weight: bold;
    color: #0A2540;
}

.pagination {
    margin-top: 30px;
    text-align: center;
}

.pagination button {
    padding: 8px 14px;
    margin: 5px;
    border: none;
    background: #0A2540;
    color: white;
    cursor: pointer;
    border-radius: 4px;
}

    </style>
</head>

<body>

<!-- Navbar -->
<header>
    <div class="logo">
        <img src="images/home.png" alt="EliteHomes Logo" style="height:36px;">
        <span style="font-size:24px;font-weight:700;color:#FFFFFF;">
            Elite<span style="color:#C9A227;">Homes</span>
        </span>
    </div>
    <nav style="
    display:flex;
    align-items:center;
    gap:30px;
">

        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>

        <!-- AUTH AREA -->
        <div id="authArea" style="
        display:flex;
        align-items:center;
        gap:12px;
        margin-left:20px;
    ">
            <a href="login.html" id="loginBtn" style="color:white;">Login</a>
        </div>

    </nav>


</header>

<!-- Page Header -->


<!-- Content Section -->
<section class="content">

        <!-- Dynamic title -->
        <h2 id="resultTitle" style="margin-bottom:30px;"></h2>

        <!-- Property cards will come here -->
        <div id="propertyGrid" class="property-grid"></div>

        <!-- Pagination buttons -->
        <div id="pagination" class="pagination"></div>



</section>

<!-- Footer -->
<footer>
    <p>© 2025 EliteHomes. All rights reserved.</p>
    <p>Built with professionalism & trust.</p>
</footer>
<script>
    /* ------------------ CITY LIST (SAME AS BEFORE) ------------------ */
    const cities = [
        "Mumbai","Delhi","Bangalore","Hyderabad","Chennai","Kolkata",
        "Pune","Ahmedabad","Jaipur","Chandigarh","Indore","Bhopal",
        "Lucknow","Kanpur","Agra","Varanasi","Prayagraj","Patna",
        "Ranchi","Jamshedpur","Dhanbad","Bhubaneswar","Cuttack",
        "Raipur","Bilaspur","Nagpur","Amravati","Nashik","Aurangabad",
        "Thane","Kalyan","Dombivli","Panvel","Murbad","Ulhasnagar",
        "Mangalore","Udupi","Manipal","Hubli","Dharwad","Belgaum",
        "Shimoga","Davangere","Chitradurga","Mysore","Mandya",
        "Madurai","Trichy","Coimbatore","Salem","Erode","Vellore",
        "Tirunelveli","Thoothukudi","Nagercoil","Kochi","Trivandrum",
        "Kozhikode","Thrissur","Kannur","Palakkad","Alappuzha",
        "Kollam","Kottayam","Vijayawada","Guntur","Vizag","Rajahmundry",
        "Tirupati","Nellore","Kurnool","Anantapur","Kadapa",
        "Warangal","Karimnagar","Nizamabad","Sangareddy",
        "Noida","Greater Noida","Ghaziabad","Faridabad","Gurgaon"
    ];

    /* ------------------ STATIC PROPERTIES (UNCHANGED) ------------------ */
    const staticProperties = [];

    cities.forEach(city => {
        for (let i = 1; i <= 10; i++) {
            staticProperties.push({
                city: city.toLowerCase(),
                type: "apartment",
                title: `${city} Property ${i}`,
                price: `${50 + i * 5}`,
                imageUrl: `images/properties/house${i}.jpg`
            });
        }
    });

    /* ------------------ URL PARAMS ------------------ */
    const params = new URLSearchParams(window.location.search);
    const cityParam = params.get("city")?.toLowerCase();
    const actionParam = params.get("type") || "Buy";

    document.getElementById("resultTitle").innerText =
        `${actionParam} Properties in ${cityParam.toUpperCase()}`;

    /* ------------------ GRID + PAGINATION ------------------ */
    const grid = document.getElementById("propertyGrid");
    const pagination = document.getElementById("pagination");

    const itemsPerPage = 6;
    let currentPage = 1;
    let filtered = [];

    /* ------------------ BACKEND FIRST, FALLBACK STATIC ------------------ */
    fetch(`http://localhost:8083/api/properties/search?city=${cityParam}`)
        .then(res => res.json())
        .then(data => {
            if (data.length > 0) {
                filtered = data;
            } else {
                filtered = staticProperties.filter(p => p.city === cityParam);
            }
            renderPage(currentPage);
            renderPagination();
        })
        .catch(() => {
            // backend down → static fallback
            filtered = staticProperties.filter(p => p.city === cityParam);
            renderPage(currentPage);
            renderPagination();
        });

    /* ------------------ RENDER PAGE ------------------ */
    function renderPage(page) {
        grid.innerHTML = "";

        const start = (page - 1) * itemsPerPage;
        const end = start + itemsPerPage;

        filtered.slice(start, end).forEach(p => {
            const imgPath = p.imageUrl.startsWith("images")
                ? p.imageUrl
                : `http://localhost:8083/${p.imageUrl}`;

            grid.innerHTML += `
<div class="property-card"
     onclick="openProperty(
        '${p.city}',
        '${p.type}',
        '${actionParam}',
        '${imgPath}',
        '₹${p.price}'
     )">
    <img src="${imgPath}">
    <div class="property-info">
        <h3>${p.title}</h3>
        <p>${p.city.toUpperCase()}</p>
        <p class="price">₹${p.price}</p>
    </div>
</div>
`;
        });
    }

    /* ------------------ PAGINATION ------------------ */
    function renderPagination() {
        pagination.innerHTML = "";
        const totalPages = Math.ceil(filtered.length / itemsPerPage);

        for (let i = 1; i <= totalPages; i++) {
            const btn = document.createElement("button");
            btn.innerText = i;
            btn.onclick = () => {
                currentPage = i;
                renderPage(currentPage);
            };
            pagination.appendChild(btn);
        }
    }

    /* ------------------ OPEN PROPERTY ------------------ */
    function openProperty(city, type, action, image, price) {
        window.location.href =
            `property-details.html?city=${encodeURIComponent(city)}
            &type=${encodeURIComponent(type)}
            &action=${encodeURIComponent(action)}
            &image=${encodeURIComponent(image)}
            &price=${encodeURIComponent(price)}`;
    }
</script>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        // -------- AUTH GUARD --------
        if (localStorage.getItem("isLoggedIn") !== "true") {
            console.log("Not logged in, redirecting to login.html");
            window.location.href = "login.html";
            return;
        }
        const authArea = document.getElementById("authArea");
        const sellerLink = document.getElementById("sellerLink");
        // Safer default values
        const username = localStorage.getItem("username") || "User";
        const role = localStorage.getItem("role") || "user";
        // -------- SHOW USERNAME + LOGOUT BUTTON --------
        if (authArea) {
            authArea.innerHTML = `
               
                <a href="#" id="logoutBtn">Logout</a>
            `;
        }
        // -------- LOGOUT FUNCTIONALITY --------
        const logoutBtn = document.getElementById("logoutBtn");
        if (logoutBtn) {
            logoutBtn.addEventListener("click", () => {
                localStorage.clear();
                window.location.href = "login.html";
            });
        }
    });
</script>

</body>
</html>
